knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(plyr)
library(stringr)
race_df = read_csv("../../data/00-raw-data/race_results.csv")
circuit_df = read_csv("../../data/00-raw-data/circuit_info.csv")
driver_df = read_csv('../../data/00-raw-data/drivers.csv')
colnames(race_df) = c('index', 'season', 'round', 'url', 'raceName', 'Circuit', 'date', 'Results', 'time')
drop = c("index", "url")
race_df = race_df[,!(names(race_df) %in% drop)]
colnames(circuit_df) = c('index', 'circuitId', 'url', 'circuitName', 'Location')
drop = c("index", "url")
circuit_df = circuit_df[,!(names(circuit_df) %in% drop)]
race_df = race_df %>%
mutate(across('Circuit', str_replace, fixed("{"), ''),
across('Circuit', str_replace, fixed("}"), ''))
race_df$circuitId =  word(race_df$Circuit,1,sep = ",")
race_df$circuitId = word(race_df$circuitId,2,sep = ": ")
race_df$circuitId = gsub("'", "", race_df$circuitId)
df = merge(race_df, circuit_df, by = 'circuitId', all.x = TRUE)
df = df[order(df$season, df$round), ]
head(df)
head(driver_df)
df$Results_Position_1 =  word(df$Results,1,sep = fixed(", {'number'"))
df$Results_Position_2 =  word(df$Results,2,sep = fixed(", {'number'"))
df$Results_Position_3 =  word(df$Results,3,sep = fixed(", {'number'"))
df$Results_Position_4 =  word(df$Results,4,sep = fixed(", {'number'"))
df$Results_Position_5 =  word(df$Results,5,sep = fixed(", {'number'"))
df$Driver_Position_1 = word(df$Results_Position_1,2,sep = fixed(","))
df$Driver_Position_2 = word(df$Results_Position_2,2,sep = fixed(","))
df$Driver_Position_3 = word(df$Results_Position_3,2,sep = fixed(","))
df$Driver_Position_4 = word(df$Results_Position_4,2,sep = fixed(","))
df$Driver_Position_5 = word(df$Results_Position_5,2,sep = fixed(","))
df$Driver_Position_1 = word(df$Driver_Position_1,2,sep = fixed(": "))
df$Driver_Position_2 = word(df$Driver_Position_2,2,sep = fixed(": "))
df$Driver_Position_3 = word(df$Driver_Position_3,2,sep = fixed(": "))
df$Driver_Position_4 = word(df$Driver_Position_4,2,sep = fixed(": "))
df$Driver_Position_5 = word(df$Driver_Position_5,2,sep = fixed(": "))
df$Driver_Points_1 = word(df$Results_Position_1,4,sep = fixed(","))
df$Driver_Points_2 = word(df$Results_Position_2,4,sep = fixed(","))
df$Driver_Points_3 = word(df$Results_Position_3,4,sep = fixed(","))
df$Driver_Points_4 = word(df$Results_Position_4,4,sep = fixed(","))
df$Driver_Points_5 = word(df$Results_Position_5,4,sep = fixed(","))
df$Driver_Points_1 = word(df$Driver_Points_1,2,sep = fixed(": "))
df$Driver_Points_2 = word(df$Driver_Points_2,2,sep = fixed(": "))
df$Driver_Points_3 = word(df$Driver_Points_3,2,sep = fixed(": "))
df$Driver_Points_4 = word(df$Driver_Points_4,2,sep = fixed(": "))
df$Driver_Points_5 = word(df$Driver_Points_5,2,sep = fixed(": "))
df$Driver_Info_1 = word(df$Results_Position_1,2,sep = fixed("'Driver': {"))
df$Driver_Info_2 = word(df$Results_Position_2,2,sep = fixed("'Driver': {"))
df$Driver_Info_3 = word(df$Results_Position_3,2,sep = fixed("'Driver': {"))
df$Driver_Info_4 = word(df$Results_Position_4,2,sep = fixed("'Driver': {"))
df$Driver_Info_5 = word(df$Results_Position_5,2,sep = fixed("'Driver': {"))
df$driverRef_1 = word(df$Driver_Info_1,1,sep = fixed(","))
df$driverRef_2 = word(df$Driver_Info_2,1,sep = fixed(","))
df$driverRef_3 = word(df$Driver_Info_3,1,sep = fixed(","))
df$driverRef_4 = word(df$Driver_Info_4,1,sep = fixed(","))
df$driverRef_5 = word(df$Driver_Info_5,1,sep = fixed(","))
df$driverRef_1 = word(df$driverRef_1,2,sep = fixed(": "))
df$driverRef_2 = word(df$driverRef_2,2,sep = fixed(": "))
df$driverRef_3 = word(df$driverRef_3,2,sep = fixed(": "))
df$driverRef_4 = word(df$driverRef_4,2,sep = fixed(": "))
df$driverRef_5 = word(df$driverRef_5,2,sep = fixed(": "))
df$Constructor_Info_1 = word(df$Results_Position_1,2,sep = fixed("'Constructor': {"))
df$Constructor_Info_2 = word(df$Results_Position_2,2,sep = fixed("'Constructor': {"))
df$Constructor_Info_3 = word(df$Results_Position_3,2,sep = fixed("'Constructor': {"))
df$Constructor_Info_4 = word(df$Results_Position_4,2,sep = fixed("'Constructor': {"))
df$Constructor_Info_5 = word(df$Results_Position_5,2,sep = fixed("'Constructor': {"))
df$constructorRef_1 = word(df$Constructor_Info_1,1,sep = fixed(","))
df$constructorRef_2 = word(df$Constructor_Info_2,1,sep = fixed(","))
df$constructorRef_3 = word(df$Constructor_Info_3,1,sep = fixed(","))
df$constructorRef_4 = word(df$Constructor_Info_4,1,sep = fixed(","))
df$constructorRef_5 = word(df$Constructor_Info_5,1,sep = fixed(","))
df$constructorRef_1 = word(df$constructorRef_1,2,sep = fixed(": "))
df$constructorRef_2 = word(df$constructorRef_2,2,sep = fixed(": "))
df$constructorRef_3 = word(df$constructorRef_3,2,sep = fixed(": "))
df$constructorRef_4 = word(df$constructorRef_4,2,sep = fixed(": "))
df$constructorRef_5 = word(df$constructorRef_5,2,sep = fixed(": "))
df$otherinfo_1 = word(df$Results_Position_1,2,sep = fixed("'grid'"))
df$otherinfo_2 = word(df$Results_Position_2,2,sep = fixed("'grid'"))
df$otherinfo_3 = word(df$Results_Position_3,2,sep = fixed("'grid'"))
df$otherinfo_4 = word(df$Results_Position_4,2,sep = fixed("'grid'"))
df$otherinfo_5 = word(df$Results_Position_5,2,sep = fixed("'grid'"))
df$grid_pos_1 = word(df$otherinfo_1,1,sep = fixed(","))
df$grid_pos_2 = word(df$otherinfo_2,1,sep = fixed(","))
df$grid_pos_3 = word(df$otherinfo_3,1,sep = fixed(","))
df$grid_pos_4 = word(df$otherinfo_4,1,sep = fixed(","))
df$grid_pos_5 = word(df$otherinfo_5,1,sep = fixed(","))
df$completed_laps_1 = word(df$otherinfo_1,2,sep = fixed(","))
df$completed_laps_2 = word(df$otherinfo_2,2,sep = fixed(","))
df$completed_laps_3 = word(df$otherinfo_3,2,sep = fixed(","))
df$completed_laps_4 = word(df$otherinfo_4,2,sep = fixed(","))
df$completed_laps_5 = word(df$otherinfo_5,2,sep = fixed(","))
df$race_status_1 = word(df$otherinfo_1,3,sep = fixed(","))
df$race_status_2 = word(df$otherinfo_2,3,sep = fixed(","))
df$race_status_3 = word(df$otherinfo_3,3,sep = fixed(","))
df$race_status_4 = word(df$otherinfo_4,3,sep = fixed(","))
df$race_status_5 = word(df$otherinfo_5,3,sep = fixed(","))
df$race_time_1 = word(df$otherinfo_1,2,sep = fixed("'Time':"))
df$race_time_2 = word(df$otherinfo_2,2,sep = fixed("'Time':"))
df$race_time_3 = word(df$otherinfo_3,2,sep = fixed("'Time':"))
df$race_time_4 = word(df$otherinfo_4,2,sep = fixed("'Time':"))
df$race_time_5 = word(df$otherinfo_5,2,sep = fixed("'Time':"))
df$grid_pos_1 = word(df$grid_pos_1,2,sep = fixed(": "))
df$grid_pos_2 = word(df$grid_pos_2,2,sep = fixed(": "))
df$grid_pos_3 = word(df$grid_pos_3,2,sep = fixed(": "))
df$grid_pos_4 = word(df$grid_pos_4,2,sep = fixed(": "))
df$grid_pos_5 = word(df$grid_pos_5,2,sep = fixed(": "))
df$completed_laps_1 = word(df$completed_laps_1,2,sep = fixed(": "))
df$completed_laps_2 = word(df$completed_laps_2,2,sep = fixed(": "))
df$completed_laps_3 = word(df$completed_laps_3,2,sep = fixed(": "))
df$completed_laps_4 = word(df$completed_laps_4,2,sep = fixed(": "))
df$completed_laps_5 = word(df$completed_laps_5,2,sep = fixed(": "))
df$race_status_1 = word(df$race_status_1,2,sep = fixed(": "))
df$race_status_2 = word(df$race_status_2,2,sep = fixed(": "))
df$race_status_3 = word(df$race_status_3,2,sep = fixed(": "))
df$race_status_4 = word(df$race_status_4,2,sep = fixed(": "))
df$race_status_5 = word(df$race_status_5,2,sep = fixed(": "))
drop = c("Driver_Info_1", "Driver_Info_2", "Driver_Info_3", "Driver_Info_4", "Driver_Info_5", "Constructor_Info_1", "Constructor_Info_2", "Constructor_Info_3", "Constructor_Info_4", "Constructor_Info_5", "Driver_Info_1", "Driver_Info_1", "Driver_Info_1", "Driver_Info_1", "Driver_Info_1", "Circuit", "Results", "otherinfo_1", "otherinfo_2", "otherinfo_3", "otherinfo_4", "otherinfo_5", "Results_Position_1", "Results_Position_2", "Results_Position_3", "Results_Position_4", "Results_Position_5", "time")
df = df[,!(names(df) %in% drop)]
num_cols = c('Driver_Position_1', 'Driver_Position_2', 'Driver_Position_3', 'Driver_Position_4', 'Driver_Position_5',
'Driver_Points_1', 'Driver_Points_2', 'Driver_Points_3', 'Driver_Points_4', 'Driver_Points_5',
'grid_pos_1', 'grid_pos_2', 'grid_pos_3', 'grid_pos_4', 'grid_pos_5',
'completed_laps_1', 'completed_laps_2', 'completed_laps_3', 'completed_laps_4', 'completed_laps_5')
fn <- function(x) gsub("'", "", x)
fncol <- colwise(fn, .cols=num_cols)
df[, num_cols] = fncol(df)
df[num_cols] = sapply(df[num_cols], as.numeric)
colnames(df)
df2 = df[rep(seq_len(nrow(df)), each = 5), ]
rownames(df2) <- 1:nrow(df2)
df2
write_csv(df2, '../../data/01-modified-data/data_cleaning_R.csv', na = '') #to python
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(plyr)
library(stringr)
race_df = read_csv("../../data/00-raw-data/race_results.csv")
circuit_df = read_csv("../../data/00-raw-data/circuit_info.csv")
driver_df = read_csv('../../data/00-raw-data/drivers.csv')
colnames(race_df) = c('index', 'season', 'round', 'url', 'raceName', 'Circuit', 'date', 'Results', 'time')
drop = c("index", "url")
race_df = race_df[,!(names(race_df) %in% drop)]
colnames(circuit_df) = c('index', 'circuitId', 'url', 'circuitName', 'Location')
drop = c("index", "url")
circuit_df = circuit_df[,!(names(circuit_df) %in% drop)]
race_df = race_df %>%
mutate(across('Circuit', str_replace, fixed("{"), ''),
across('Circuit', str_replace, fixed("}"), ''))
race_df$circuitId =  word(race_df$Circuit,1,sep = ",")
race_df$circuitId = word(race_df$circuitId,2,sep = ": ")
race_df$circuitId = gsub("'", "", race_df$circuitId)
df = merge(race_df, circuit_df, by = 'circuitId', all.x = TRUE)
df = df[order(df$season, df$round), ]
head(df)
head(driver_df)
df$Results_Position_1 =  word(df$Results,1,sep = fixed(", {'number'"))
df$Results_Position_2 =  word(df$Results,2,sep = fixed(", {'number'"))
df$Results_Position_3 =  word(df$Results,3,sep = fixed(", {'number'"))
df$Results_Position_4 =  word(df$Results,4,sep = fixed(", {'number'"))
df$Results_Position_5 =  word(df$Results,5,sep = fixed(", {'number'"))
df$Driver_Position_1 = word(df$Results_Position_1,2,sep = fixed(","))
df$Driver_Position_2 = word(df$Results_Position_2,2,sep = fixed(","))
df$Driver_Position_3 = word(df$Results_Position_3,2,sep = fixed(","))
df$Driver_Position_4 = word(df$Results_Position_4,2,sep = fixed(","))
df$Driver_Position_5 = word(df$Results_Position_5,2,sep = fixed(","))
df$Driver_Position_1 = word(df$Driver_Position_1,2,sep = fixed(": "))
df$Driver_Position_2 = word(df$Driver_Position_2,2,sep = fixed(": "))
df$Driver_Position_3 = word(df$Driver_Position_3,2,sep = fixed(": "))
df$Driver_Position_4 = word(df$Driver_Position_4,2,sep = fixed(": "))
df$Driver_Position_5 = word(df$Driver_Position_5,2,sep = fixed(": "))
df$Driver_Points_1 = word(df$Results_Position_1,4,sep = fixed(","))
df$Driver_Points_2 = word(df$Results_Position_2,4,sep = fixed(","))
df$Driver_Points_3 = word(df$Results_Position_3,4,sep = fixed(","))
df$Driver_Points_4 = word(df$Results_Position_4,4,sep = fixed(","))
df$Driver_Points_5 = word(df$Results_Position_5,4,sep = fixed(","))
df$Driver_Points_1 = word(df$Driver_Points_1,2,sep = fixed(": "))
df$Driver_Points_2 = word(df$Driver_Points_2,2,sep = fixed(": "))
df$Driver_Points_3 = word(df$Driver_Points_3,2,sep = fixed(": "))
df$Driver_Points_4 = word(df$Driver_Points_4,2,sep = fixed(": "))
df$Driver_Points_5 = word(df$Driver_Points_5,2,sep = fixed(": "))
df$Driver_Info_1 = word(df$Results_Position_1,2,sep = fixed("'Driver': {"))
df$Driver_Info_2 = word(df$Results_Position_2,2,sep = fixed("'Driver': {"))
df$Driver_Info_3 = word(df$Results_Position_3,2,sep = fixed("'Driver': {"))
df$Driver_Info_4 = word(df$Results_Position_4,2,sep = fixed("'Driver': {"))
df$Driver_Info_5 = word(df$Results_Position_5,2,sep = fixed("'Driver': {"))
df$driverRef_1 = word(df$Driver_Info_1,1,sep = fixed(","))
df$driverRef_2 = word(df$Driver_Info_2,1,sep = fixed(","))
df$driverRef_3 = word(df$Driver_Info_3,1,sep = fixed(","))
df$driverRef_4 = word(df$Driver_Info_4,1,sep = fixed(","))
df$driverRef_5 = word(df$Driver_Info_5,1,sep = fixed(","))
df$driverRef_1 = word(df$driverRef_1,2,sep = fixed(": "))
df$driverRef_2 = word(df$driverRef_2,2,sep = fixed(": "))
df$driverRef_3 = word(df$driverRef_3,2,sep = fixed(": "))
df$driverRef_4 = word(df$driverRef_4,2,sep = fixed(": "))
df$driverRef_5 = word(df$driverRef_5,2,sep = fixed(": "))
df$Constructor_Info_1 = word(df$Results_Position_1,2,sep = fixed("'Constructor': {"))
df$Constructor_Info_2 = word(df$Results_Position_2,2,sep = fixed("'Constructor': {"))
df$Constructor_Info_3 = word(df$Results_Position_3,2,sep = fixed("'Constructor': {"))
df$Constructor_Info_4 = word(df$Results_Position_4,2,sep = fixed("'Constructor': {"))
df$Constructor_Info_5 = word(df$Results_Position_5,2,sep = fixed("'Constructor': {"))
df$constructorRef_1 = word(df$Constructor_Info_1,1,sep = fixed(","))
df$constructorRef_2 = word(df$Constructor_Info_2,1,sep = fixed(","))
df$constructorRef_3 = word(df$Constructor_Info_3,1,sep = fixed(","))
df$constructorRef_4 = word(df$Constructor_Info_4,1,sep = fixed(","))
df$constructorRef_5 = word(df$Constructor_Info_5,1,sep = fixed(","))
df$constructorRef_1 = word(df$constructorRef_1,2,sep = fixed(": "))
df$constructorRef_2 = word(df$constructorRef_2,2,sep = fixed(": "))
df$constructorRef_3 = word(df$constructorRef_3,2,sep = fixed(": "))
df$constructorRef_4 = word(df$constructorRef_4,2,sep = fixed(": "))
df$constructorRef_5 = word(df$constructorRef_5,2,sep = fixed(": "))
df$otherinfo_1 = word(df$Results_Position_1,2,sep = fixed("'grid'"))
df$otherinfo_2 = word(df$Results_Position_2,2,sep = fixed("'grid'"))
df$otherinfo_3 = word(df$Results_Position_3,2,sep = fixed("'grid'"))
df$otherinfo_4 = word(df$Results_Position_4,2,sep = fixed("'grid'"))
df$otherinfo_5 = word(df$Results_Position_5,2,sep = fixed("'grid'"))
df$grid_pos_1 = word(df$otherinfo_1,1,sep = fixed(","))
df$grid_pos_2 = word(df$otherinfo_2,1,sep = fixed(","))
df$grid_pos_3 = word(df$otherinfo_3,1,sep = fixed(","))
df$grid_pos_4 = word(df$otherinfo_4,1,sep = fixed(","))
df$grid_pos_5 = word(df$otherinfo_5,1,sep = fixed(","))
df$completed_laps_1 = word(df$otherinfo_1,2,sep = fixed(","))
df$completed_laps_2 = word(df$otherinfo_2,2,sep = fixed(","))
df$completed_laps_3 = word(df$otherinfo_3,2,sep = fixed(","))
df$completed_laps_4 = word(df$otherinfo_4,2,sep = fixed(","))
df$completed_laps_5 = word(df$otherinfo_5,2,sep = fixed(","))
df$race_status_1 = word(df$otherinfo_1,3,sep = fixed(","))
df$race_status_2 = word(df$otherinfo_2,3,sep = fixed(","))
df$race_status_3 = word(df$otherinfo_3,3,sep = fixed(","))
df$race_status_4 = word(df$otherinfo_4,3,sep = fixed(","))
df$race_status_5 = word(df$otherinfo_5,3,sep = fixed(","))
df$race_time_1 = word(df$otherinfo_1,2,sep = fixed("'Time':"))
df$race_time_2 = word(df$otherinfo_2,2,sep = fixed("'Time':"))
df$race_time_3 = word(df$otherinfo_3,2,sep = fixed("'Time':"))
df$race_time_4 = word(df$otherinfo_4,2,sep = fixed("'Time':"))
df$race_time_5 = word(df$otherinfo_5,2,sep = fixed("'Time':"))
df$grid_pos_1 = word(df$grid_pos_1,2,sep = fixed(": "))
df$grid_pos_2 = word(df$grid_pos_2,2,sep = fixed(": "))
df$grid_pos_3 = word(df$grid_pos_3,2,sep = fixed(": "))
df$grid_pos_4 = word(df$grid_pos_4,2,sep = fixed(": "))
df$grid_pos_5 = word(df$grid_pos_5,2,sep = fixed(": "))
df$completed_laps_1 = word(df$completed_laps_1,2,sep = fixed(": "))
df$completed_laps_2 = word(df$completed_laps_2,2,sep = fixed(": "))
df$completed_laps_3 = word(df$completed_laps_3,2,sep = fixed(": "))
df$completed_laps_4 = word(df$completed_laps_4,2,sep = fixed(": "))
df$completed_laps_5 = word(df$completed_laps_5,2,sep = fixed(": "))
df$race_status_1 = word(df$race_status_1,2,sep = fixed(": "))
df$race_status_2 = word(df$race_status_2,2,sep = fixed(": "))
df$race_status_3 = word(df$race_status_3,2,sep = fixed(": "))
df$race_status_4 = word(df$race_status_4,2,sep = fixed(": "))
df$race_status_5 = word(df$race_status_5,2,sep = fixed(": "))
drop = c("Driver_Info_1", "Driver_Info_2", "Driver_Info_3", "Driver_Info_4", "Driver_Info_5", "Constructor_Info_1", "Constructor_Info_2", "Constructor_Info_3", "Constructor_Info_4", "Constructor_Info_5", "Driver_Info_1", "Driver_Info_1", "Driver_Info_1", "Driver_Info_1", "Driver_Info_1", "Circuit", "Results", "otherinfo_1", "otherinfo_2", "otherinfo_3", "otherinfo_4", "otherinfo_5", "Results_Position_1", "Results_Position_2", "Results_Position_3", "Results_Position_4", "Results_Position_5", "time")
df = df[,!(names(df) %in% drop)]
num_cols = c('Driver_Position_1', 'Driver_Position_2', 'Driver_Position_3', 'Driver_Position_4', 'Driver_Position_5',
'Driver_Points_1', 'Driver_Points_2', 'Driver_Points_3', 'Driver_Points_4', 'Driver_Points_5',
'grid_pos_1', 'grid_pos_2', 'grid_pos_3', 'grid_pos_4', 'grid_pos_5',
'completed_laps_1', 'completed_laps_2', 'completed_laps_3', 'completed_laps_4', 'completed_laps_5')
fn <- function(x) gsub("'", "", x)
fncol <- colwise(fn, .cols=num_cols)
df[, num_cols] = fncol(df)
df[num_cols] = sapply(df[num_cols], as.numeric)
colnames(df)
df2 = df[rep(seq_len(nrow(df)), each = 5), ]
rownames(df2) <- 1:nrow(df2)
head(df2)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(dplyr)
library(caret)
library(e1071)
library(caTools)
library(yardstick)
library(naivebayes)
library(ggplot2)
library(psych)
library(sjPlot)
library(klaR)
df = read_csv("../../data/01-modified-data/data_cleaned.csv")
df = read_csv("../../data/02-model-data/data_cleaned.csv")
head(df)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(dplyr)
library(caret)
library(e1071)
library(caTools)
library(yardstick)
library(naivebayes)
library(ggplot2)
library(psych)
library(sjPlot)
library(klaR)
df = read_csv("../../data/02-model-data/data_cleaned.csv")
head(df)
barplot(table(df$label), col = 'lightblue', main = 'Distribution of Labels', xlab = 'Labels', ylab = 'Count')
plot(df$cumulative_points, df$win_history, col = 'lightblue', main = 'Points vs Win History', xlab = 'Cumulative Points', ylab = 'Win History')
a = factor(df$status, levels = unique(df$status))
df$status = as.integer(a)
a = factor(df$constructorRef, levels = unique(df$constructorRef))
df$constructorRef = as.integer(a)
a = factor(df$weather, levels = unique(df$weather))
df$weather = as.integer(a)
a = factor(df$stop, levels = unique(df$stop))
df$stop = as.integer(a)
a = factor(df$label, levels = unique(df$label))
df$label = as.integer(a)
df = df[-c(1:3)]
df$label = as.factor(df$label)
df
set.seed(1973)
sample <- sample(c(TRUE, FALSE), nrow(df), replace=TRUE, prob=c(0.8,0.2))
train  <- df[sample, ]
test   <- df[!sample, ]
nrow(train)
nrow(test)
set.seed(1973)
model1=NaiveBayes(label ~., data=train)
model = naive_bayes(label ~., data=train)
plot(model1)
train_pred=predict(model,train)
train_cm = table(train_pred,train$label)
confusionMatrix(train_cm)
test_pred=predict(model,test)
test_cm = table(test_pred,test$label)
confusionMatrix(test_cm)
train_cm_df = data.frame(train_cm)
colnames(train_cm_df) = c('pred', 'truth', 'y')
ggplot(data = train_cm_df, mapping = aes(x = truth , y = pred)) +
geom_tile(aes(fill = y), colour = "white") +
labs(title = 'Confusion Matrix of Train Data') +
scale_x_discrete(labels=c("1" = "Podium", "2" = "Top_10", "3" = "Outide_Top_10")) +
scale_y_discrete(labels=c("1" = "Podium", "2" = "Top_10", "3" = "Outide_Top_10")) +
geom_text(aes(label = sprintf("%1.0f", y)), vjust = 1, colour = 'white') +
#scale_fill_gradient(low = "lightblue", high = "yellow") +
theme_bw() + theme(legend.position = "none")
test_cm_df = data.frame(test_cm)
colnames(test_cm_df) = c('pred', 'truth', 'y')
ggplot(data = test_cm_df, mapping = aes(x = truth , y = pred)) +
geom_tile(aes(fill = y), colour = "white") +
labs(title = 'Confusion Matrix of Test Data') +
scale_x_discrete(labels=c("1" = "Podium", "2" = "Top_10", "3" = "Outide_Top_10")) +
scale_y_discrete(labels=c("1" = "Podium", "2" = "Top_10", "3" = "Outide_Top_10")) +
geom_text(aes(label = sprintf("%1.0f", y)), vjust = 1, colour = 'white') +
# scale_fill_gradient(low = "cyan", high = "darkgoldenrod1") +
theme_bw() + theme(legend.position = "none")
model1
